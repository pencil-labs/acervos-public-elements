<link rel="import" href="../../polymer/polymer-element.html">
<link rel="import" href="../../paper-card/paper-card.html">
<link rel="import" href="../../iron-image/iron-image.html">
<link rel="import" href="../../paper-button/paper-button.html">
<link rel="import" href="../../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../iron-icons/iron-icons.html">

<dom-module id="public-elements-card-show">
  <template>
    <style>
      :host {
        display: none;
        position: absolute;
        left: 0; right: 0;
        top: 0; bottom: 0;
        transition: opacity ease 0.35s;
        opacity: 0;
        z-index: 999;
        overflow: auto;
      }
      paper-card {
        height: inherit;
        width: inherit;
      }
      .show-header { @apply(--paper-font-headline); }
      .show-light { color: var(--paper-grey-600); }
    </style>
    <public-elements-service id="ajax"></public-elements-service>
    <paper-card id="card" image="{{_imagePath(cardItem)}}">
      <div class="card-content">
        <div class="show-header">
          {{cardItem.term}}
        </div>
        <div class="show-light">
          {{cardItem.description}}
        </div>
      </div>
      <div class="card-actions">
      </div>
      <paper-icon-button icon="close" on-tap="dismiss"></paper-icon-button>
    </paper-card>
  </template>

  <script>
    /**
     * `public-elements-card-show`
     *
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class PublicElementsCardShow extends Polymer.Element {
      static get is() {
        return 'public-elements-card-show';
      }
      static get properties() {
        return {
          cardItem: {
            type: Object,
            observer: 'showCard'
          },
          service: {
            type: String,
            value: 'projects/5a0b07ca7d421f096f6f3c93/pubmedia'
          }
        };
      }

      constructor() {
        super()
      }

      present() {
        this.style.opacity = '0';
        this.style.display = 'block';
        setTimeout(function() {
          this.style.opacity = '1';
        }.bind(this), 200);
      }

      dismiss() {
        this.style.opacity = '0';
        setTimeout(function() {
          this.style.display = 'none';
        }.bind(this), 400);
        this.dispatchEvent(new CustomEvent('dismiss-show'));
      }

      showCard(cardItem) {
        if(!cardItem) return;
        this.present();
      }

      _imagePath(cardItem) {
        if(!cardItem || !cardItem._medias || !cardItem._medias.length) return;
        return `${this.$.ajax.api}/${this.service}/${cardItem._item}/${cardItem._medias[0].filename}`;
      }
    }

    window.customElements.define(PublicElementsCardShow.is, PublicElementsCardShow);
  </script>
</dom-module>
