<link rel="import" href="../../polymer/polymer-element.html">
<link rel="import" href="../../iron-image/iron-image.html">
<link rel="import" href="../../paper-button/paper-button.html">
<link rel="import" href="../../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../iron-icons/iron-icons.html">

<dom-module id="acervos-card-show">
  <template>
    <style>
      :host {
        display: none;
        position: absolute;
        left: 0; right: 0;
        top: 0; bottom: 0;
        transition: opacity ease 0.35s;
        opacity: 0;
        z-index: 999;
        overflow: auto;
      }
      #card {
        min-height: 100%;
        min-width: 100%;
        background: white;
      }
      .image {
        height: calc(100vh - 80px);
      }
      iron-image {
        height: 100%;
        width: 100%;
      }
      [middle-item] {
        display: flex;
        width: 100%;
      }
      .actions {
        display: inline-block;
        vertical-align: top;
        padding: 5px 0;
      }
      .show-header {
        display: inline-block;
        margin: 0 30px;
        font-family: Roboto;
        font-weight: bold;
        color: black;
        font-size: 2.1rem;
        line-height: 3.2rem;
        flex: 1;
        flex-grow: 1;
      }
      .show-light { color: var(--paper-grey-600); }
    </style>
    <acervos-service id="ajax"></acervos-service>
    <div id="card">
      <app-toolbar>
        <div middle-item>
          <div class="actions">
            <paper-icon-button icon="info-outline" on-tap="toggle"></paper-icon-button>
          </div>
          <div class="show-header">{{_setTitle(cardItem)}}</div>
          <div class="actions">
            <paper-icon-button icon="close" on-tap="dismiss"></paper-icon-button>
          </div>
        </div>
      </app-toolbar>
      <div class="image">
        <iron-image src="{{_imagePath(cardItem)}}" sizing="contain"></iron-image>
      </div>
      <div class="card-content">
        <div class="show-header">
          {{cardItem.term}}
        </div>
        <div class="show-light">
          {{cardItem.description}}
        </div>
      </div>
      <div class="card-actions">
      </div>
    </div>
  </template>

  <script>
    /**
     * `acervos-card-show`
     *
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class PublicElementsCardShow extends Polymer.Element {
      static get is() {
        return 'acervos-card-show';
      }
      static get properties() {
        return {
          cardItem: {
            type: Object,
            observer: 'showCard'
          },
          service: {
            type: String,
            value: 'projects/5a0b07ca7d421f096f6f3c93/pubmedia'
          }
        };
      }

      constructor() {
        super()
      }

      present() {
        this.style.opacity = '0';
        this.style.display = 'block';
        setTimeout(function() {
          this.style.opacity = '1';
        }.bind(this), 200);
      }

      dismiss() {
        this.style.opacity = '0';
        this.cardItem = undefined;
        setTimeout(function() {
          this.style.display = 'none';
        }.bind(this), 400);
        this.dispatchEvent(new CustomEvent('dismiss-show'));
      }

      showCard(cardItem) {
        if(!cardItem) return;
        this.present();
      }

      _imagePath(cardItem) {
        if (!cardItem || !cardItem.image) return;
        return cardItem.image;
      }

      _setTitle(cardItem) {
        if (!cardItem) return;
        return cardItem.name || cardItem.term;
      }
    }

    window.customElements.define(PublicElementsCardShow.is, PublicElementsCardShow);
  </script>
</dom-module>
